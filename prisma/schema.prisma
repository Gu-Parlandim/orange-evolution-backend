generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Users {
  id           String         @id @default(uuid())
  name         String
  email        String         @unique
  password     String
  role         Role           @default(USER)
  xp           Int
  created_at   DateTime       @default(now())
  Dates        Dates[]
  UserTrails   UserTrails[]
  UserContents UserContents[]
}

model Trails {
  id          Int          @id @default(autoincrement())
  name        String
  hours       Int
  description String
  created_at  DateTime     @default(now())
  Contents    Contents[]
  UserTrails  UserTrails[]
}

model Contents {
  id                  Int           @id @default(autoincrement())
  title               String
  description         String
  link                String
  type                String
  duration            DateTime      @db.Time(0)
  created_at          DateTime      @default(now())
  trail               Trails        @relation(fields: [trail_id], references: [id])
  trail_id            Int
  category            Category      @relation(fields: [category_id], references: [id])
  category_id         String
  UserContents        UserContents? @relation(fields: [userContentsUser_id], references: [user_id])
  userContentsUser_id String?
}

model Category {
  id       String     @id @default(uuid())
  name     String
  Contents Contents[]
}

model Dates {
  id      Int      @id @default(autoincrement())
  date    DateTime @db.Date
  count   Int
  level   Int
  user    Users    @relation(fields: [user_id], references: [id])
  user_id String
}

model UserTrails {
  user         Users          @relation(fields: [user_id], references: [id])
  user_id      String
  trail        Trails         @relation(fields: [trail_id], references: [id])
  trail_id     Int
  UserContents UserContents[]

  @@id([user_id, trail_id])
}

model UserContents {
  user               Users      @relation(fields: [user_id], references: [id])
  user_id            String     @id
  contents           Contents[]
  status             Status     @default(DEFAULT)
  user_trail         UserTrails @relation(fields: [user_trail_user_id, user_trail_id], references: [user_id, trail_id])
  user_trail_user_id String
  user_trail_id      Int
}

enum Role {
  ADMIN
  USER
}

enum Status {
  DEFAULT
  IN_PROGRESS
  FINISHED
}
